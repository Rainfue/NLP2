В настоящее время нейронные сети используются во многих отраслях
промышленности для решения сложных задач, которые ранее было трудно или
невозможно решить традиционными методами. Одной из областей, где
нейросетевое управление показало большие перспективы, является область
прогнозного моделирования, где искусственные нейронные сети (ИНС) используются для прогнозирования результатов работы сложных систем. 
Одним из наиболее интересных применений ИНС является область компьютерного зрения, где нейронные сети используются для анализа изображений и видеоданных. В последние годы методы компьютерного зрения используются для прогнозирования состояния биологических объектов, таких как
растения, животные и даже люди [1]. Например, компания Cattle Care использует методы компьютерного зрения и ИНС для отслеживания жизненного
цикла КРС [2]. 
Существует множество преимуществ прогнозирования биологических
состояний с помощью ИНС. Например, ИНС предоставляют исследователям и
врачам информацию о состоянии пациента в режиме реального времени, что
позволяет проводить более своевременное и целенаправленное лечение [3]. 
ИНС также можно использовать для выявления биомаркеров, которые могут
быть использованы для предсказания начала заболевания до появления симптомов, что позволяет проводить более раннюю диагностику и лечение [4, 5]. 
В сельском хозяйстве ИНС находят применение для увеличения точности
прогнозирования состояния урожая, для расчета необходимых удобрений и пестицидов [6, 7]. Необходимо отметить, что наиболее развито использование
современных информационных технологий, включающих методы искусственного интеллекта и ИНС, в точном растениеводстве, а в точном животноводстве
цифровизация отрасли несколько отстает, при этом возникают правовые проблемы использования методов искусственного интеллекта [8, 9]. 
Целью настоящей статьи является исследование точной и эффективной
модели для классификации и прогнозирования здоровья крупного рогатого
скота (КРС) в режиме реального времени при разработке интеллектуальной
системы видеомониторинга. Большое внимание уделяется модели, способной
классифицировать различные аспекты поведения крупного рогатого скота, такие как кормление, отдых или признаки дистресса. В будущем модель должна
быть обучена предсказывать потенциальные проблемы со здоровьем КРС на
основе конкретных признаков, загруженных в нейронную сеть, что позволит
обнаруживать их на ранней стадии и вовремя принимать меры. 
Анализ собранных данных позволит принимать обоснованные управляющие решения относительно стратегий кормления, корректировки окружающей
среды или распределения ресурсов, что в конечном итоге может значительно
улучшить производительность и эффективность всего поголовья в молочных
хозяйствах. 
Для достижения целей исследования необходимо собирать видеоданные
из молочных хозяйств с учетом особенностей реализации систем видеонаблюдения в них, фиксируя при этом различные физиологические и поведенческие
состояния КРС. Эти данные должны быть подвергнуты методам предварительной обработки для извлечения соответствующих характеристик и аннотаций
для обучения нейросетевых моделей. В процессе работы будут исследованы
различные архитектуры нейросетей и методики их обучения, чтобы в результате получилась модель, максимально точно классифицирующая КРС. Будут
представлены и проанализированы результаты экспериментов с оценкой производительности различных сетевых архитектур и эффективности включения
конкретных признаков для прогнозирования физиологического состояния биологических объектов. Полученные результаты позволят определить потенциальные проблемы и направления дальнейших исследований. 
Обеспечение качественного распознавания является фундаментальной задачей в компьютерном зрении и системах, обучаемых с помощью нейросетевых технологий. Точное распознавание различных жизненных аспектов КРС, 
таких как поведение и некие жизненные показатели, необходимо в вопросе
обеспечения благосостояния всего поголовья. Существует несколько видов задач распознавания: 
Классификация. Данную задачу можно рассмотреть как присвоение
метки или категоризации объектам на полноценных изображениях или кадрах
видео. В рассматриваемом проекте полезно безошибочно классифицировать
не только вид животного (корова или лошадь, рис. 1), но и деятельность животного в рассматриваемый момент времени. 
Локализация. Эта задача включает в себя определение точного местоположения в кадре или получение набора координат объекта. Точная локализация (рис. 2) позволит, к примеру, своевременно определить проблемы 
с ногами или позвоночником у КРС, ведь у больной коровы походка может
сильно отличаться. 
Сегментация – это задача присвоения меток не объекту в целом, а каждому пикселю, который принадлежит объекту. Это существенно повышает
точность полученных из видео данных для дальнейшего анализа и принятия
решений. Пример сегментации будет приведен далее по ходу работы (см. рассмотрение аннотатора SuperVisely). 
Для выполнения поставленных задач на разных этапах понадобится решить все три задачи, так как для автоматического мониторинга состояния
крупного рогатого скота недостаточно просто понимать, что в кадре находится
КРС, необходимо отличать коров от предметов интерьера, от стен, людей 
и прочего, что может попасть в кадр. Также необходимо в реальном времени
отслеживать жизнедеятельность крупного рогатого скота, что невозможно без
детальной и четкой сегментации. 
На данный момент существует несколько наиболее известных нейросетевых топологий, которые применяются для решения подобных задач (например, SegNet, DeepLab и другие) [10–12]. 
В работе [13] представлена модель SegNet, которая является архитектурой
глубокого обучения, специально разработанной для семантической сегментации изображений. Модель SegNet состоит из структуры кодер–декодер, где кодер учится извлекать высокоуровневые характеристики из входного изображения, а декодер восстанавливает сегментированное изображение на основе этих
характеристик.
Статья [14] описывает современную архитектуру для семантической сегментации изображений. По словам авторов статьи, DeepLab решает такие задачи, как улавливание мелких деталей, обработка больших рецептивных полей
и сохранение пространственного разрешения. Авторы используют модифицированную версию популярной архитектуры CNN, такой как VGG-16 или
ResNet, для сбора богатой контекстной информации. В дополнение к глубокому CNN и свертке Atrous авторы используют полностью связанные CRF для
уточнения результатов сегментации. 
В статье [15] представлена архитектура конволюционной нейронной сети
(CNN), разработанной специально для задач сегментации биомедицинских
изображений. Точная сегментация имеет решающее значение для различных
приложений, включая диагностику заболеваний, планирование лечения и медицинские исследования. 
Другой моделью, ориентированной на решение задач, связанных с выделением объектов на видеоданных, является YOLOv3 [16]. Проанализируем применимость моделей U-Net и YOLOv3 для решения поставленной задачи. Обе архитектуры легко обучаемы, достаточно легко адаптируются под разные данные
и обеспечивают хорошее быстродействие, они используются для задач компьютерного зрения, хотя направленность и области применения у них разнятся. 
YOLOv3 – это нейросетевая архитектура, предназначенная для идентификации нескольких объектов на изображении или видео. Данная нейросеть делит входное изображение на сетку и назначает все ячейки данной сетки ответственными за обнаружение объектов. Данный метод позволяет обнаруживать
объекты на видео в режиме реального времени. 
U-Net, в свою очередь, предназначена для сегментации изображений, где
целью является классификация и маркировка каждого пикселя в кадре. Данная
архитектура используется в более точных областях, таких как компьютерное
определение и сегментация опухолей. 
Существенные различия между рассматриваемыми архитектурами. 
 Скорость работы. YOLOv3 значительно быстрее оппонента в плане
скорости, поэтому она является одним из лидеров в задачах обработки в режиме реального времени. 
 Точность работы. U-Net, хоть и работает ощутимо медленнее, существенно превосходит конкурента в создании высокоточных сегментаций на
кадрах. 
 Обучение. Обе архитектуры требуют аннотированных обучающих данных, но формат этих данных существенно отличается, как и формат выходных
данных. YOLOv3 требует аннотации ограничивающих рамок для обучения, тогда как U-Net требует аннотации пикселей. 
 Формат выходных данных. YOLOv3 выводит координаты рамок вместе
с вероятностью класса для всех обнаруженных объектов (объект «лошадь» 
на рис. 1), в то же время U-Net на выходе выдает сегментированное изображение, где все пиксели классифицируются по-разному. 
Для проработки на реальном видео были использованы предобученные
модели с сайта ImageAI [17], однако результат на предобученных моделях не
смог успешно определить даже малую часть коров на видео (рис. 4). Это показало, что предобученных моделей недостаточно для полноценного распознавания объектов. 
В дополнение к выбору нейросетевой архитектуры необходимо использовать инструменты аннотации, такие как SuperVisely (рис. 6) или VGG Image Annotator – VIA (рис. 7). Эти инструменты представляют собой эффективные
и удобные интерфейсы для аннотирования видеоданных. 
Для аннотирования с помощью SuperVisely исходное видео было разбито
на кадры с помощью утилиты ffmpeg (рис. 5).
В SuperVisely можно покадрово разбивать видео на области с объектами, 
тем самым формируя базу данных для сегментации. 
При попытке более точной сегментации при масштабировании кадров
видно, что области едва различимы даже для человеческого глаза, который не
нужно тренировать для распознавания коров на видео (рис. 8). При этом возникает одна из проблем при решении задачи классификации биологических
объектов в видео в задачах автоматического мониторинга их состояния: для
качественного аннотирования изображений при дальнейшей классификации 
и сегментации объектов на видео необходимо использовать изображения с высоким разрешением, что, в свою очередь, требует больших вычислительных
мощностей и увеличивает время обработки. 
С помощью VIA можно довольно быстро выделять объекты в рамки для
последующего пополнения датасета.
На этапе формирования датасета необходимо использовать методы предварительной обработки для извлечения релевантных характеристик объектов. 
Перечислим основные методы. 
 Выборка кадров. В некоторых случаях (рис. 11) далеко не все кадры
имеют значимость при формировании датасета, так как кадры могут практически не отличаться. Если видео снято в разрешении 60 кадров в секунду, а животное стоит неподвижно, то сотни кадров могут быть не нужны, так как будут
идентичными. Выборка кадров помогает сформировать множество кадров, которые будут сохранять временную характеристику, но при этом не будут использоваться дополнительные вычислительные мощности. 
 Изменение размера и масштабирование кадров. Данный метод помогает
стандартизировать датасет. Для более точного и быстрого обучения изображения должны иметь одинаковый формат. 
 Дополнение данных. Данный метод применяется для увеличения разнообразия обучающих данных. Дополнение данных включает в себя переворачивание, отзеркаливание, добавление шумов или избавление от них, высветление
или затемнение изображения, изменение цветовой гаммы и прочее 
(рис. 9–12). 
 Вычитание фона. Данный метод полезен в задаче сегментации объектов, 
где нужно отделить объекты переднего фона от элементов заднего. 
Опишем подробнее метод дополнения данных. 
С помощью VIA аннотированы объекты «корова» на разных кадрах
(рис. 9), затем с помощью скрипта на python для каждого изображения в исходной папке реализован метод дополнения данных (рис. 10), в результате которого для каждого кадра созданы перевернутое, отраженное, осветленное 
на 20 % и затемненное на 20 % изображения. 
Важно отметить, что аугментация данных должна применяться только 
к обучающему набору данных. Наборы данных для проверки и тестирования
не должны подвергаться увеличению данных, а должны содержать строго оригинальные изображения. 
Для проверки работоспособности на предобученных моделях YOLOv3 
и RetinaNET было взято небольшое видео, где человек четко будет видеть коров на видео. Существенная разница заметна в скорости выполнения программы с помощью разных моделей. 
Результат работы YOLOv3 составил 42.914 секунды. 
В свою очередь, время выполнения программы с RetinaNET заняло
218.175 секунды. 
На рис. 14 и 15 представлены результаты для некоторых кадров из исходного видео. 
Сравнение рассмотренных моделей показало только существенную разницу по скорости, точность классификации не оказалась стабильно лучше у
одной из моделей, поэтому без дополнительного обучения рано делать выводы
и расставлять приоритеты использования. 
В таблице приведен сравнительный анализ рассмотренных моделей для
видео длительностью 5 секунд. 
В работе были рассмотрены задачи распознавания объектов на видео, 
описаны основные современные нейросетевые технологии, используемые для
поставленных задач. Проведен сравнительный анализ наиболее релевантных
для решаемой задачи архитектур U-Net и YOLOv3. При использовании каждой
архитектуры выделены преимущества и недостатки. U-Net предназначена для
высокоточных сегментаций в кадре, а YOLOv3 значительно быстрее по скорости, поэтому она больше подходит для использования в режиме реального времени. Во время работы использовались аннотаторы изображений SuperVisely 
и VGG Image Annotator. С их помощью был сформирован базовый датасет, который впоследствии значительно увеличился путем аугментации данных. 
Для проверки сверточных нейросетей в задаче классификации объектов на видео были использованы предобученные модели RetinaNet и YOLOv3. 
Сформулированы следующие требования к исходным данным для эффективного решения поставленной задачи выделения и классификации биологических объектов в реальном времени: 
 Необходимо использовать камеры как можно более высокого разрешения с учетом стоимости и экономической эффективности для четкого приближения объектов на этапе аннотирования. 
 Во избежание появления слепых зон в месте обитания КРС необходимо
использовать достаточно большое количество камер, размещенных с перекрытием исследуемого пространства, чтобы объекты мониторинга были постоянно в поле видимости. Это позволит впоследствии составить общую картину
высокого разрешения, составленную из изображений всех камер, а по полученной картине осуществлять классификацию объектов посредством ИНС. 
 Для достижения необходимой точности классификации с помощью исследованных моделей ИНС RetinaNet и YOLOv3 необходимо либо самостоятельно формировать датасет из реальных данных, либо брать за основу пред-
обученные модели, но дообучать их с помощью аннотированных вручную видеоданных. 
Выявленные требования будут учтены при дальнейших исследованиях 
в рамках решения задачи автоматического мониторинга и прогнозирования состояния биологических объектов. 