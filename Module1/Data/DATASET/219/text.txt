Развитие технологий построения измерительных систем на основе интернета вещей (Internet of 
Things, IoT) является трендом современных инфокоммуникационных сетей.
Устройства IoT, как правило используют батареи в качестве источника питания, обладают низкой
вычислительной мощностью, ограниченным объемом памяти [1]. Эти ограничения обусловили разработку
протоколов, обеспечивающих передачу и обработку данных с минимальной вычислительной и коммуникационной
нагрузкой, что делает устройства интернета вещей уязвимыми к аномальному трафику – различным атакам, 
реализация которых может нанести серьезный ущерб эксплуатируемому оборудованию IoT и даже физический
ущерб людям [2].
Известно, что системы обнаружения вторжений (Intrusion Detection System, IDS) не увеличивают нагрузку на
сенсорные устройства и поэтому могут быть использованы для своевременного обнаружение аномального трафика, 
генерируемого интернетом вещей [3].
IDS для IoT представляет собой программное обеспечение, которое позволяет выявить несанкционированное
получение доступа или вредоносную атаку на данные и оповестить о нарушении безопасности. Методы, 
используемые в системах обнаружения вторжения, относятся к активным и реализуют [4]:
─ поиск по сигнатуре;
─ поиск по аномалии.
Поиск по сигнатуре – способ, позволяющий определить атаку по некоторому шаблону, составленному
по признакам известных на данное время атак. При совпадении признаков трафика и одного из шаблонов создается
оповещение о нарушении безопасности. Такой метод позволяет определять только те вторжения, которые
были ранее.
Поиск по аномалии – способ, при котором система сравнивает активность трафика с некоторой моделью
стандартного (корректного) поведения того или иного устройства. При отклонении от нормы система также
оповестит о нарушении безопасности.
Исходя из скорости развития информационных технологий в целом и отрасли интернета вещей в частности, 
есть проблема быстрого устаревания систем обнаружения вторжения. IDS нуждаются в постоянных доработках и
обновлениях, чтобы корректно реагировать на появление новых угроз, что в свою очередь требует больших
временных и финансовых затрат. 
В работе предлагается интеграция метода машинного обучения на основе самообучаемой нейронной сети в
анализ трафика, генерируемого интернетом вещей. Самообучаемая нейросеть способна самостоятельно
адаптироваться к обновляемой среде и оставаться актуальной на протяжении длительного времени.
Структура сети IoT. Взаимодействие Machine-to-Machine (М2М) является основой интернета вещей и
подключения новых устройств в единую сеть [5]. Организация М2М взаимодействия основано на протоколе CoAP 
(Constrained Application Protocol). Этот протокол разработан специально для маломощных устройств, совместим с
HTTP (HyperText Transfer Protocol) и реализует передачу данных с минимальными энергозатратами такими, как они
есть – без модификаций и инкапсулирования [6]. 
Протокол CoAP является бинарным и работает поверх UDP (User Datagram Protocol – протокол
пользовательских датаграмм), что позволяет работать с любым типом данных. Передача данных происходит
эффективнее, так как бинарный код подразумевает короткие и маловесные пакеты – уменьшается объем, 
требуемый для передачи данных и появляется гибкость при работе с различными устройствами. 
В общем случае, взаимодействие клиента с умным устройством интернета вещей выглядит, как на рис. 1, где
подразумевается, что пакеты данных с сенсорного устройства проходят через прокси-сервер, где инкапсулируются
в HTTP-пакеты.
Протокол CoAP не поддерживает режим шифрования, предусмотренный в протоколе TСP (Transmission 
Control Protocol – протокол управления передачей), а поддерживает более упрощенный вариант шифрования DTLS 
(Datagram Transport Layer Security – протокол датаграмм безопасности транспортного уровня).
Протокол DTLS может работать в одном из четырех режимов:
─ NoSec – в этом режиме шифрование отключено;
─ PreSharedKey – шифрование включено, добавляется список общих ключей шифрования AES (Advanced 
Encryption Standard – симметричный алгоритм блочного шифрования) и узлов, между которыми ведется
конфиденциальный обмен данными;
─ RawPublicKey – шифрование включено, используются асимметричные пары ключей с шифрованием по
алгоритму AES; 
─ Сертификат – шифрование включено, устройство использует сертификаты X.509 с цифровыми
подписями для распределения открытых ключей.
Методика анализа трафика. Модель трафика представляет собой закономерность изменения его основных
характеристик во времени. В описании трафика обычно учитываются три характеристики [7]:
─ тренд – описание поведения трафика во времени;
─ сезонность – закономерность роста или падения объема трафика, связанных, например, с конкретным
промежутком времени;
─ случайная составляющая – остальные характеристики, оставшиеся после исключения основных
характеристик, собственно, в которых и следует искать аномалии.
После выбора способа анализа, необходимо трафик разложить на составляющие:
 выделить тренд и сгладить исходные данные, например, при помощи скользящего окна, 
экспоненциального сглаживания или регрессии;
 вычесть или разделить сезонную составляющую из исходных данных, что зависит от выбранного способа;
─ после удаления сезонного фактора и тренда остается случайная составляющая, которая и принимается за
аномалию. 
Примерами аномалий могут быть выбросы, сдвиги, изменения распределения значений, отклонения от
среднего и совместные аномалии.
В качестве примера можно рассмотреть анализ трафика, основанный на циклическом алгоритме, 
состоящий из:
─ отбора данных;
─ сглаживания тренда;
─ поиска возможных циклов;
─ удаления трендовых компонент;
─ проверки циклов;
─ предсказания будущих циклов.
На этапе отбора данных определяется анализируемый временной ряд Xq (рис. 1). На рис. 1 изображен
временной ряд, где по оси ординат отложен объем трафика V, а по оси абсцисс – период наблюдения T. Для
дальнейшего анализа, временная шкала дискретизируется равными интервалами Δt наблюдения динамики
изменения объема трафика.
Каждый интервал Δt содержит агрегацию данных, объем которых зафиксирован в этом интервале
где q – номер интервала (q = 1, 2, …, Q);
R – число пакетов в интервале Δt;
Xq – ряд данных.
Для сглаживания необходимо исключить одиночные выбросы – (L – 1) точку. 
После удаления случайных колебаний и выравнивания значений переходят к поиску циклов. Здесь
применяется метод спектрального анализа. На графике спектра мощности (рис. 2) видны пики, образующиеся возле
определенных частот. Пики указывают на возможные циклы.
Пики свидетельствует только о вероятности наличия циклов. Поэтому проводят еще несколько шагов для
проверки наличия циклов. Одним из таких критериев является удаление трендовых компонентов. Применяя метод
скользящей средней, удаляются силы роста в данных, а затем исходя из статистической значимости методами Fкоэффициентов или хи-квадрат ищется отклонение от распределения спектра мощности.
Архитектура IDS интернета вещей. IDS для интернета вещей, имеет иерархическую структуру, как и сама
сеть IoT – три компонентных уровня. На нижнем уровне иерархии находятся кластерные беспроводные сенсорные
сети [8]. Головной узел кластера отвечает за авторизацию других членов кластера, маршрутизатор отвечает за
авторизацию головных узлов кластера, а шлюз за авторизацию маршрутизаторов.
Модуль обнаружения аномального поведения установлен в каждом кластере, интеллектуальная система
обнаружения сетевых атак на маршрутизаторах и шлюзах.
IoT-устройства оповещают о своем присутствии в конкретном кластере, направляя идентификатор (ID), 
например MAC-адрес в модуль мобильности. Модуль мобильности отвечает за регистрацию вновь прибывших в
кластер устройств и удаление вышедших из кластера устройств. Любой вновь прибывший узел проходит
процедуру аутентификации [9].
Модуль синхронизации представляет собой тактовый генератор – формирование временных окон (слотов) и
соответственно раундов беспроводной сенсорной сети, во время которых происходит опрос IoT-устройств.
Модуль обнаружения аномального поведения реализуется программно по приведенной в статье методике
анализа трафика. 
На уровне сети обнаружение атак реализуется программной моделью глубокого обучения, например, 
нейронной сетью или случайным лесом [10]. 
Модуль вычисления доверия позволяет в онлайн режиме удалять скомпрометированные узлы из списка
доверенных узлов, на основании которого формируется таблица маршрутизации.
Заключение. Предложенная в статье методика анализа трафика с целью поиска аномалий, несущих атаку на
устройства интернета вещей, является частью системы обнаружения вторжений и реализует свои функции на
нижнем уровне архитектуры интернета вещей, то есть на уровне сенсорных устройств и кластеров беспроводной
сенсорной сети.
Последовательность шагов методики направлена на выделение из трафика, генерируемого сенсорными
устройствами интернета вещей случайной составляющей, оставшиеся после исключения основных характеристик, 
в которой может содержаться аномалия. 