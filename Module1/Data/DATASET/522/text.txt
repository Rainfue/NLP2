В условиях современности существует большое количество
электронных систем, позволяющих переводить ДС электронным путем.
Развитие электронных сервисов привело к появлению систем,
использующих криптовалюты. Несмотря на отсутствие платежной
способности криптовалюты вне своей системы, спрос и предложение
обеспечили данный сектор экономики значительным ростом объема
капитализации с декабря 2014 года по декабрь 2021 года вырос в 395,5 раз,
увеличившись с 5,5 млрд. долл. до 2192,9 млрд. долл.
А отсутствие единой схемы законодательного регулирования переводов
криптовалюты, внутри использующихся систем делают их
привлекательным инструментом для ОД/ФТ. Объем криптовалюты
полученной от незаконной деятельности вырос в 3,04 раза с 4,6 млрд. долл.
2017 года до 14 млрд. долл. в 2021 
По данным отчета «The 2021 Crypto Crime Report» от Chainanalysis на
2021 год транзакции более 100$ пришли всего на 1867 адресов, таким
образом, на эти адреса приходится 75% всего объема незаконных средств
за 2020 год. При этом 270 из них отвечают за 55% этого объема.
Концентрация значительного объема нелегальной криптовалюты вокруг
небольшого количества адресов говорит о достаточности наличия
небольшого числа адресов для функционирования нелегального сектора
внутри криптосети. Это связано с трудностью идентификации владельцев
5,5 7,1 17,7
610,1
125,7 195,7
755,1
2192,9
0,0
500,0
1000,0
1500,0
2000,0
2500,0
2014 2015 2016 2017 2018 2019 2020 2021
Млн. долл.
4,6 4,4
11,7
7,8
14
0
2
4
6
8
10
12
14
16
2017 2018 2019 2020 2021
Млн. долл
170
этих адресов, а также широкими возможностями по переводу ДС из одного
блокчейна в другой, так как очень немногие программные продукты KYT
имеют возможности по анализу сразу большого числа блокчейнов. Еще
одной особенностью 2021 года стал рост использования DeFi в целях ОД
на 1964%; с 2% от общего объема до 17%, по сравнению с 2020ым годом и
продолжение роста выручки даркнет-маркетов [2].
Одной из новых платформ представленных на криптобиржах является
Hedera Hashgraph — распределенный реестр 3-ьего поколения
(некоторыми экспертами считается 4ым поколением, так как по
классификации и тестам является аналогам Solana), с открытым исходным
кодом, основанный на технологии Hashgraph. Данный реестр запустил
свою основную рабочую сеть (mainnet) в 2019 году и за время своего
существования занял 34 место по капитализации среди подобных систем.
Hedera Hashgraph представлена для обмена на 85 крипто обменниках и
является одной из наиболее перспективных систем в 2022 году, а также
планирует внедрить Defi инфраструктуру [3, 4].
С учетом возможного резкого роста Hedera Hashgraph при внедрении
DeFi, подобно блокчейну Solana, который вырос в 749,05 раз только за 2021
год, с 70 млн. долл. на 31 декабря 2020 года до 52,704 млн долл. на 31
декабря 2021 года и постоянным ростом рынка DeFi и ОД в нем, возникают
серьезные риски значительного повышения ОД посредством DeFi в Hedera
Hashgraph [2, 5].
Для противодействия и снижению рисков ОД/ФТ требуется комплекс
законодательных и технических мер, который в упрощенном виде может
быть представлен в виде четырёх этапов:
­ разработка специальных законодательных актов;
­ закрепление необходимости и формата сопроводительной
информации;
­ налогообложение операций с криптовалютам;
­ разработка ПО, обеспечивающего отслеживание транзакций.
Ключевыми этапами выступают первый и четвёртый, позволяющие
законодательно определить статус ВВ в государстве и отслеживать
операции с ними соответственно.
В отличие от других отраслей финансового рынка, рынок криптовалют
больше подвержен значительным изменениям и постоянным появлениям
новых инструментов, например, таких как DeFi, NFT, DAO.
Ключевыми тенденциями рынка критовалют на 2022 год являются [2,
6-8]:
­ рост DeFi с 2020 года до апреля 2022 года (рисунок 3);
­ рост NFT (рисунок 4);
171
­ рост ОД посредством криптовалют на 180% с 7,8 млрд. долл. в 2020
году до 14 млрд. долл. в 2021 году ОД;
­ рост ОД в DeFi 1964%;
­ рост ОД в NFT на 1914%, с 175 млн. долл. до 3350 млн. долл.
­ смена поколений распределенных реестров;
­ увеличение вложений в блокчейн;
­ прогнозируемый спад;
­ увеличение интереса к блокчейнам 3ьего и 4ого поколений,
особенно предлагающих инфраструктуру для DeFi;
­ рост числа BaaS;
­ рост концентрации сетей.
Есть как положительные тенденции, так и отрицательные. Оценить
какие из тенденций останутся, а какие пойдут на спад проблематично, так
как рынок криптовалют имеет тенденцию реагировать на появление новых
технологий с определенным запозданием. Большая часть прорывных
технологий становится популярной только через период в 3-5 лет после
своего появления. Например, в биткоине который появился в 2009 объем
операций стал значительным только в 2014. Или DeFi, первый сервис
появился в 2017 году, а сама технология испытала значительный рост
популярности только в 2020 году [9]. Многие из нововведений и новых
криптовалют быстро отсеиваются либо остаются почти без внимания, а те
же, которым удалось привлечь внимание пользователей в течении 1-2
годов, а вместе с тем, и спрос к своей платформе (и криптовалюте), обычно,
со временем становятся устоявшимся инструментом. Однако, реагировать
на события подобные резкому росту рынка NFT или капитализации Solana
стоит уже сейчас, а потому изменения рынка криптовалют и его тенденции
должны быть в сфере повышенного внимания правоохранительных
органов.
Отличительными особенностями ОД в сфере криптовалют являются [2,
8, 10]:
­ концентрация вокруг группы адресов;
­ рост использования новых технологий, таких как DeFi и NFT;
­ относительная простота схем перемещения средств;
173
­ высокая доля транзакций малого объема (до 100 долл.);
­ развитие микширования.
ЦБ РФ в 2022 году был выложен аналитический отчет «Криптовалюты:
тренды, риски, меры» в рамках которого была рассмотрена ситуация с
регулированием операций с криптовалюми в разных странах [11].
Несмотря на интенсивную работу многих международных и национальных
государственных организаций, многие из микросфер внутри рынка
криптовалют находятся вне полноценного законодательного
регулирования, например, DeFi и NFT. Некоторые из государств напрямую
сталкиваются с ОД посредством криптобирж в больших объемах [12].
Среди предложенных ЦБ РФ мер были такие как:
­ введение запрета на обмен и обращения криптовалюты
криптобиржами, криптообменниками, P2P-платформами на территории
РФ;
­ полный запрет на операции с криптовалютами для организаций;
­ расширение международного сотрудничества, в особенности с
государствами ЕАЭС;
­ совершенствование механизма обмена информацией между ФНС,
РФМ и ЦБ РФ, а также с иностранными регуляторами криптовалютных
бирж;
­ разработка механизмов и мер обнаружения нарушения запрета п.1 и
создание уполномоченного органа для работы данного механизма.
Отличительной чертой данного набора мер является их законодательная
направленность. В соответствии с 4 этапной схемой регулирования
криптовалют, весь комплекс мер будет относиться ко второму этапу. При
этом, было отмечено, что требуется постоянный мониторинг ситуации на
рынке криптовалют, его тенденций и угроз. Однако реализация п.5 будет
частично относиться и к 4 этапу по разработке ПО, обеспечивающего
отслеживание транзакций в сети интернет. Разработка СПО требует, как
понимания его особенностей, так и предназначения. Наибольшие
трудности вызывает чёткое понимание предназначения, так как требуются
не только знания в области разработки ПО, но и в профильной области
одновременно. Например, какие алгоритмы анализа стоит применить, а
когда и какие из них неприменимы.
Для разработки СПО для отслеживания транзакций потребуется
понимание принципов отслеживания, возможностей микширования и
переводов между блокчейнами и получения информации от
международных органов. Также, СПО для отслеживания транзакций
потребуется, как удобный функционал для работы с блокчейном той или
иной криптовалюты, так и собственного маркирования объектов на основе
внешней информации, а также возможность поиска в глубину от
174
определенных узлов и фильтрации типов транзакций. На основании
вышеуказанных особенностей можно выделить следующие ключевые
меры в СПО по ПОД посредством криптовалют:
Во-первых, кластеризация для выделения схожих групп адресов. Вовторых, отслеживание крупных транзакций:
­ получение списка транзакций и анализ крупных, начинающихся с
определенного порогового значения;
­ анализ большого числа маленьких транзакций с одного или группы
схожих адресов.
­ В-третьих, создание черных списков и отслеживание движения
средств в них:
­ нелегальные адреса;
­ централизованные микшеры;
­ криптобиржи в государствах без достаточного регулирования.
На основании данных мер можно значительно сократить риски ОД.
Часть этих мер уже включена в рекомендации ФАТФ. Процесс ОД тесно
связан с процессом ФТ. В сфере криптовалют легализованные средства
могут быть с легкостью использованы для ФТ, так как находятся вне
повышенного внимания правоохранительных органов. Препятствуя
процессу ОД, можно значительно сократить риски ФТ.
Среди технических мер, наилучшим образом показывают себя методы
кластеризации и анализа графов, так как требуют для обучения алгоритма
наименьшее количество входных данных [13].
ГМ уже применяются как в расследовании криптопреступлений, так и
для удобства восприятия CT в мониторинге транзакций, например модуле
Reactor продукта Chainalysis KYT. Граф и ГМ способны обеспечить поиск
в глубину и наличие черного списка, благодаря чему хорошо подходят для
мониторинга транзакций, а благодаря возможности маркирования
объектов на графе повышается удобство расследования уже совершенных
преступлений. Они же могут применяться и для деанонимизации.
Среди основных графовых методов для анализа выделяют [14]:
­ кластеризация – объединение схожим по заданному атрибуту узлов
или транзакций в группы;
­ ранжирование. Расположение узлов или транзакций в определенном
порядке, зависящем от заданного атрибута;
­ поиск в глубину и ширину;
­ поиск пути, в том числе, кратчайшего;
­ обнаружение циклов;
­ поиск минимального остовного дерево;
­ поиск сильно связных компонент.
175
Часть из этих алгоритмов применима и для поиска аномалий в графе
транзакций, например кластеризация или поиск сильно связных компонент
для поиска непрямых потенциальных взаимосвязей между объектами, а
также поиск пути и поиск в глубину.
На основе графа удобно проводить блокчейнз-анализ, являющийся
одним из лучших инструментов для ПОД/ФТ в сфере криптовалют.
Блокчейн можно рассматривать как ориентированный ациклический граф.
Так блокчейн представляет собой набор блоков из транзаций. Каждая
транзакция имеет несколько входов и один выход, т.е. может быть
представлена посредством направленного графа с несколькими входными
рёбрами и 1 выходным. Также возможен вариант графа с указанием связи
между узлами (рисунок 5).
Рисунок 5 – Пример представления транзакций в виде графа
С учетом вышесказанного, граф и ГМ являются одними из наиболее
удобных и эффективных инструментов как для мониторинга транзакций,
так и для расследования преступлений. СПО, реализующее мониторинг
транзакций является одной из основных мер четвертого этапа (ключевого)
по организации регулирования рынка криптовалют.
Для создания СПО требуется:
­ анализ функциональности существующих аналогов;
­ разработка модели данных;
­ выбор алгоритмов анализа;
­ выбор инструмента создания (язык программирования или low-code
платформа).
В рамках анализа функциональности существующих аналогов были
отобраны наиболее популярные программы анализа блокчейнов [15]:
­ Chainalysis KYT;
­ TRM Transaction Monitoring;
­ Anchainai CISO;
176
­ Amberdata;
­ Bitquery coinpath;
­ Chainbeat;
­ Crystal Blockchain;
­ Ciphertrace;
­ COINFIRM;
­ Uppsalasecurity.
Далее были проанализированы доступные в них виды блокчейнов 3 и 4
поколения [16]:
­ Solana;
­ Polkadot;
­ Hedera;
­ Cardano;
­ BSC;
­ Cosmos;
­ Filecoin (FIL);
­ Avalanche;
­ Polygon;
­ NEAR.
Блокчейны для анализа отбирались по критерию нахождения по
крайней мере в топ 100 по капитализации криптосети [17]. В результат
анализа было выявлено, что наибольшее число блокчейнов 3 и 4 поколения
поддерживает Chainanalysis KYT, и только оно же (KYT) поддерживает
Hedera Hashgraph.
В рамках следующего этапа были сформированы требования к СПО. С
учетом продолжительности работы в СПО по мониторингу транзакций
требуется также возможность сохранения проекта и продолжения работы с
ним в последующем, а также возможности обновления данных при
загрузке проекта о транзакциях представленных в проекте узлов. Также,
для удобства визуализации схем и анализа, требуется маркирование узлов
(например, выбор цвета узла) и транзакций, их фильтрация и удаление
(облегчение схемы для удобства ее восприятия и анализа, а также удаление
легальных транзакций). Еще одним аспектом важным для анализа
транзакций является получение всей доступной информации о ней. Ввиду
большого объема данных, вывод дополнительных данных желателен
отдельно, по требованию. Для анализа транзакций и узлов на
принадлежность к единой группе требуется применение алгоритмов
кластеризации.
Резюмируя вышесказанное можно выдвинуть следующие требования
для СПО:
177
­ графовое представление данных, с возможностью загрузки данных
об узлах и добавления новых по идентификатору аккаунта;
­ отдельный вывод данных о всех транзакциях и балансе аккаунта по
требованию;
­ возможность сохранения и загрузки проекта;
­ кластеризация узлов.
Для разработки приложения была выбрана архитектура вебприложения позволяющая создать кроссплатформенное приложение. Для
разработки веб-приложения был выбран язык программирования
JavaScript, так как:
­ использование JavaScript открывает возможность по выбору из
широкого круга фреймворков для динамического отображения графов [18];
­ Кроссплатформенность;
­ возможность реализации шаблона SPA –– гибкость и отзывчивость
пользовательского интерфейса. Постоянное обновление данных о графе
требует постоянного изменения на веб-страницы;
­ распределение нагрузки в виде выбора режима рендеринга вебстраницы –– снижение нагрузки на браузер пользователя благодаря
распределению на client-side и server-side компоненты.
В рамках дальнейшего выбора стека технологий для разработки были
рассмотрены фреймворки для работы с графами. Среди фреймворков
представленных на https://openbase.com/categories/js/best-javascript-graphlibraries были отобраны те, что имеют более тысячи оценок (согласно
данным github), имеют возможность построения графов (например,
@xstate/react такой возможности не имеет) и не связаны напрямую с
определенным фреймворком (например, echarts-for-react). В результате был
получен следующий список:
­ D3.js;
­ C3.js;
­ Vis.js;
­ dagre;
­ Springy;
­ Go.js;
­ sigma.js;
­ cytoscape.js;
­ G6.
Все библиотеки кроме C3.js имеют встроенные средства для построения
графов, поэтому C3.js была исключена из дальнейшего рассмотрения.
Следующим из ключевых параметров при дальнейшем рассмотрении стало
наличие алгоритмов расположения узлов и рёбер для улучшения анализа
178
больших графов. Одной из особенностей графов с большим числом узлов
и рёбер является трудность их восприятия
Учитывая данную проблему, одной из ключевых особенностей
библиотек по отображению графов часто являются алгоритмы
расположения узлов, значительно упрощающие при их применении
восприятие графа. Среди рассмотренных библиотек, 5 из них имеют
значительное количество алгоритмов расположения узлов:
­ D3.js;
­ Sigma.js;
­ Cytoscape.js;
­ G6.js;
­ Go.js.
Однако, не все из алгоритмов будут полезны при расположении узлов
(криптокошельков) и транзакций. Например, Pack и Partition фокусируются
на иерархической структуре данных и мало полезны для не полностью
иерархических данных. В тот момент как большая часть фреймворков
фокусируются на алгоритмах для простого отображения данных, в D3.js,
cytoscape.js и G6.js представлены алгоритмы для аналитических
179
отображений, упрощающих восприятие данных со сложной структурой.
Почти все представленные в D3.js алгоритмы применяются для
отображения иерархически данных. Cytoscape.js и G6.js же имеют
наибольшее число полезных для анализа алгоритмов не иерархической
направленности.
Среди всех фреймворков для работы с графами был выбран cytoscape.js,
выпущенный под лицензией MIT [19]. Cytoscape.js имеет наибольшее
количество полезных алгоритмов для анализа блокчейна. Он обеспечивает
работу с большим числом узлов и рёбер, удобный интерфейс по работе с
узлами и их графической стилизации, а также возможность обработки
различных событий. Еще одним значительным преимуществом cytoscape.js
над большим числом фреймворков является понятная и подробная
документация.
Минусами Cytoscape.js являются:
­ отсутствие возможности использовать GPU, в отличие от G6.js, что
негативно влияет на производительность фреймворка при расчете
расположения узлов;
­ рендеринг посредством canvas, а не WebGL как у sigma.js, что
негативно влияет на производительность фреймворка при рендеринге
больших графов;
­ В результате, cytoscape.js хорошо подходит для анализа не слишком
больших графов, так как имеет не лучшую производительность, чего
достаточно для отображения графа связей блокчейна, но при этом
запускается во всех современных браузерах и имеет большое число
алгоритмов для анализа графов.
Разработка веб-приложения на Nuxt.js обеспечивается созданием
компонентов. Компоненты могут использоваться много раз, обмениваться
данными и являются динамическими [20]. Благодаря динамичности и
возможности обмена данных, имеется возможность организовать
реагирование на события в cytoscape.js.
На основе выработанных выше требований были созданы следующие
компоненты (рисунок 7):
­ Graph.vue;
­ InfoList.vue;
­ AddNodeForm.vue;
­ Navbar.vue.
InfoList.vue отвечает за отображение данных о выбранных узлах на
отдельной панели. Для выбранных узлов отображаются следующие
элементы (рисунок 8):
­ баланс криптовалюты;
­ баланс токенов;
­ транзакции и всех их данные.
AddNodeForm.vue отвечает за передачу данных об узле для добавления
и переключении желаемого режима расположения узлов. Navbar.vue
181
отвечает за возможность сохранения и загрузки проектов. Graph.vue
отвечает за логику работы с графом и обеспечивает:
­ добавление и удаление данных;
­ расположение узлов;
­ сброс расположения узлов;
­ возможность передвижения узлов мышью;
­ отмены действия.
В результате, созданное приложение позволяет менять модель
расположения узлов, удалять и добавлять узлы, а также получать всю
информацию об аккаунтах и их транзакциях. Также возможны сохранение
и загрузка проекта. Еще одной небольшой особенностью приложения
является возможность организации удобного поиска в глубину.