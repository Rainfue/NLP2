В настоящее время существует большое число конфиденциальных сетей, в которых необходимо обеспечить защиту секретной или иной информации, представляющей особую ценность 
для ее владельца. Один из способов надежной защиты от внешних угроз – изолировать такие 
сети, сделав их недоступными из других внешних сетей. Тем не менее возникают случаи, когда 
требуется передавать информацию между такими сетями независимо от их конфиденциального характера, либо обеспечить безопасную передачу данных из недоверенных сетей в конфиденциальную сеть. По сути, речь идет о реализации модели контроля и управления доступом 
Белла – Лападулы, предполагающей однонаправленную передачу данных от субъекта с низким 
уровнем доступа к объекту с высоким уровнем конфиденциальности [1]. 
Однонаправленная передача данных предполагает, что устройство в компьютерных сетях может только передавать данные или только получать их. При этом устройство – источник данных – 
может осуществлять их передачу одному или нескольким устройствам – приемникам, но последние не могут передавать данные источнику. Однонаправленная передача данных применяется 
для безопасной передачи информации, например, файлов, журналов событий, почтовых сообщений, промышленных протоколов, обновлений программного обеспечения. При этом гарантия однонаправленного потока информации означает, что конфиденциальная информация может быть 
передана без ущерба для целостности или конфиденциальности информации в сети.
Известны различные средства однонаправленной передачи данных на основании программного решения, такие как межсетевые экраны [2, 3] и специализированные аппаратные решения 
(диоды данных). Первые имеют избыточный функционал, эффективно снижают уровень угроз, 
но не обязательно предотвращают их. Во многих случаях они достаточны, чтобы остановить 
незначительные угрозы информационной безопасности. Однако современные киберугрозы являются сложными и отличаются скоординированными атаками сразу с нескольких векторов. В этом 
случае внешние угрозы могут быть предотвращены путем их физического отделения от защищаемых сетей, например, с помощью оптической гальванической развязки между ними. Однако отсутствие маршрутизируемого и управляемого подключения в некоторой степени снижает 
их гибкость и не позволяет адаптироваться к требованиям конкретных информационных систем. 
Сложные угрозы могут использовать скоординированную и настойчивую тактику для преодоления эшелонированной защиты, паролей, многофакторной аутентификации и даже биометрии, 
но преодолеть физический разрыв (оптическую гальваническую развязку) в диоде данных с помощью существующих инструментов по-прежнему невозможно.
В статье проведен анализ функциональности существующих специализированных аппаратно-программных средств однонаправленной передачи данных. Предлагается решение, устраняющее их основные недостатки.
Анализ существующих решений
На основании информации, предоставленной в открытом доступе, существующие программно-аппаратные решения, предположительно, работают на основе физической реализации однонаправленной передачи путем использования в одних случаях гальванической развязки, в других – с помощью программного обеспечения. Гальваническую развязку можно реализовать, применяя оптический канал, работающий на передачу по одному оптическому волокну. Основываясь 
на данном методе, передать данные можно по известному транспортному протоколу UDP. Кроме 
того, необходимо использовать прокси-серверы на передающей и принимающей сторонах для 
организации двунаправленного взаимодействия с конечными пользователями. Применение прокси-серверов позволит хранить данные как на передающей стороне, так и на принимающей.
Аппаратно-программный комплекс АМТ InfoDiode (рис. 1) [4] обеспечивает изоляцию критичных информационных систем, сохраняя при этом нужный уровень их функциональности 
для взаимодействия со смежными информационными системами. Передача трафика возможна 
только в одном направлении: гальваническая развязка гарантирует отсутствие обратной связи. 
Прокси-серверы обеспечивают связь с внешними системами и организуют однонаправленный 
транспорт данных между собой. Для внешних систем прокси-сервер выступает в роли сервера 
данных (FTP\FTPS, SMTP\StartTLS, CIFS), на передающей системе – в роли клиента.
Техническое средство однонаправленной передачи данных «Диод-2С» [5] предназначено для однонаправленной передачи данных из информационных систем с низкой степенью 
конфиденциальности (секретности), в том числе из интернета, в информационные системы с высокой степенью конфиденциальности (секретности).
В основе решения Fox DataDiode [6] лежит аппаратная часть, обеспечивающая одностороннее сетевое соединение. Блок Fox DataDiode уникален тем, что гарантирует односторонний трафик на физическом уровне: у него нет программного обеспечения или прошивки, следовательно, 
им нельзя манипулировать или произвести неправильную настройку. Однако полная инсталляция Fox DataDiode (рис. 3) включает программное обеспечение прокси-серверов с обеих сторон 
Fox DataDiode, которые преобразуют двунаправленные протоколы в односторонние, и наоборот.
С учетом специфики области применения рассматриваемых средств можно выделить их следующие недостатки: 
– невозможность однозначно определить, каким образом гарантируется однонаправленная 
передача данных, так как производители не предоставляют таких сведений и не раскрывают коммерческую тайну по производству этих средств;
– невозможность определить дополнительный скрытый функционал, который может присутствовать в данных средствах;
– зависимость от производителя в рамках сервисного и гарантийного обслуживания;
– невозможность замены составных частей альтернативными отечественными решениями;
– сложность внедрения в существующие информационные системы.
Разработка архитектуры аппаратно-программного средства
Архитектура аппаратно-программного средства однонаправленной передачи данных разрабатывалась на основании следующих требований:
• физическая изоляция информационных систем;
• однонаправленная передача файлов данных;
• однонаправленная передача потока данных (UDP);
• однонаправленная передача журналов событий (syslog).
Функциональность предлагаемого средства однонаправленной передачи данных обеспечивает архитектурное решение (рис. 4), включающее два медиаконвертера, два прокси-сервера, оптический разветвитель (сплиттер).
Медиаконвертеры имеют один Ethernet-интерфейс и оптический интерфейс, представленный 
двумя оптическими модулями: TX – фотопередатчик, RX – фотоприемник. Разделение оптического интерфейса медиаконвертера на два модуля гарантирует физически однонаправленную передачу при использовании со стороны-отправителя TX-модуля, а на стороне-получателе – RX. 
Наличие активной (по умолчанию) функции LLR (Link Loss Return) говорит о том, что передатчик оптического порта (TX) конвертера выключается, если приемник (RX) не получает сигнала. 
Особенностью предлагаемой архитектуры аппаратной части является наличие оптического разветвителя (сплиттера) для организации передачи сигналов на RX-модуль стороны-отправителя.
Для реализации однонаправленного шлюза на канальном уровне модели OSI источнику и приемнику информации необходимо адресовать пакеты согласно уникальным идентификаторам, называемым MAC-адресами (Media Access Control). Предварительно по протоколу ARP (Address 
Resolution Protocol) нужно обменяться информацией для установления соответствия MAC-адреса и IP-адреса компьютера, с которым необходимо взаимодействовать. Однако при однонаправленном канале передачи данных обмен информацией произведен не будет. Одним из способов решения данной проблемы является установление статического соответствия MAC-адреса 
и IP-адреса на устройстве-отправителе. Для работы на сетевом и транспортном уровнях модели 
взаимодействия OSI при однонаправленной передаче данных следует использовать протоколы 
без установления логической связи, которая подразумевает двунаправленное взаимодействие. 
Протокол IP на сетевом уровне является протоколом без установления логической связи. 
Другой вариант реализации передачи данных на IP-адрес получателя – мультикастовая передача, которая не предполагает предварительно настроенную ARP-запись. Следовательно, 
устройство-отправитель данных при однонаправленной передаче будет отправлять информацию 
на мультикастовый адрес, например, 224.0.0.1, а устройство-получатель, в свою очередь, будет 
прослушивать и ожидать данные на указанный адрес. Мультикастовая передача данных имеет 
ряд преимуществ по сравнению с передачей на конкретный IP-адрес:
• прокси-сервер на стороне-отправителе не зависит от настроенного IP-адреса прокси-сервера на стороне-получателе;
• отсутствует необходимость настраивать статическую ARP-запись на прокси-сервере отправителя;
• нет необходимости изменять настройки прокси-сервера отправителя при изменении IP-адреса на прокси-сервере получателя;
• для повышения целостности при однонаправленной передаче данных может использоваться несколько прокси-серверов получателей, которые будут подключены через коммутатор и получать мультикастовые данные.
При использовании транспортных протоколов следует выбрать UDP, который является дейтаграммным протоколом, реализующим так называемый ненадежный сервис по возможности, 
не гарантирующий доставку сообщений адресату, но обеспечивающий работу без необходимости предварительного сообщения для установки специальных каналов передачи. Прокси-серверы 
отправителя и получателя обеспечивают однонаправленную передачу данных, например файлов, 
работая на транспортном уровне UDP модели OSI через медиаконвертеры следующим образом:
• прокси-сервер отправителя получает файлы данных из открытой сети посредством двунаправленного взаимодействия и протоколов SMB, FTP, SFTP и т. д.;
• ввиду отсутствия двунаправленного взаимодействия между прокси-сервером отправителя 
и прокси-сервером получателя, необходимо организовать статическую ARP-запись на стороне-отправителе;
• программное обеспечение (ПО) на стороне-получателе постоянно прослушивает порт 
на определенном IP-адресе и ожидает приема UDP-дейтаграмм, преобразуя их в исходное сообщение (файлы данных) и сохраняя их в памяти;
• ПО на стороне-отправителе постоянно проверяет наличие файлов данных в памяти и при их 
наличии начинает процесс однонаправленной передачи на заранее настроенный IP-адрес и порт 
получателя через Socket, который, в свою очередь, работает по транспортному протоколу UDP;
• после передачи на стороне-получателе проверяется контрольная сумма переданных файлов 
данных по предварительно переданной информации о контрольной сумме от отправителя.
Достоверность передачи обеспечивается путем избыточности (многократной передачи) 
и проверки контрольной суммы каждый раз. После передачи и успешной проверки контрольной 
суммы на стороне-получателе клиенты из закрытой сети (сети ограниченного взаимодействия) 
получают переданные файлы от прокси-сервера данных посредством двунаправленного взаимодействия и протоколов SMB, FTP, SFTP [7] и т. д.

Предложенное архитектурное решение было реализовано в виде макетного образца на основе 
медиаконвертеров DMC-F15SC [8] и сплиттера. Медиаконвертер имеет физически разделенные 
модули фотопередатчика и фотоприемника. Программное обеспечение прокси-серверов функционирует на аппаратной платформе в виде одноплатных компьютеров Raspberry PI 4 и написано 
на языке программирования Python. 
Выводы
1. Предложенная архитектура аппаратной и программной частей позволила реализовать отечественное импортозамещающее средство однонаправленной передачи данных, обеспечивающее 
гарантированное одностороннее взаимодействие, реализуемое на физическом уровне. Особенности данной архитектуры – гарантированная однонаправленная передача данных, использование 
прокси-серверов для обеспечения двунаправленного взаимодействия устройства с конечными 
пользователями, работа на существующем стеке протоколов TCP/IP.
2. При атаке на критически важные производственные и транспортные системы средства однонаправленной передачи данных помогут сохранить элементы контроля и управления важной 
инфраструктурой в неприкосновенности, не нарушая при этом работу всей системы. Физическая 
изоляция, невозможность передачи данных в одном из направлений фактически лишают злоумышленников шансов на реализацию вредоносных замыслов